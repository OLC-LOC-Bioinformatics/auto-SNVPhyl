2017-05-26 16:02:53,487 - INFO - [Elapsed time: 0.00] Creating history AutoSNVPhyl_26-05-2017
2017-05-26 16:02:53,579 - INFO - [Elapsed time: 0.09] c8990a1b374598b0
2017-05-26 16:02:53,579 - INFO - [Elapsed time: 0.09] Uploading files to galaxy...
2017-05-26 16:02:53,579 - INFO - [Elapsed time: 0.09] Finding files on the NAS...
2017-05-26 16:02:54,442 - INFO - [Elapsed time: 0.96] Uploading files from the NAS...
2017-05-26 16:02:54,442 - INFO - [Elapsed time: 0.96] 1 of 7: Uploading /mnt/nas/MiSeq_Backup/141017/2014-SEQ-0484_S8_L001_R1_001.fastq.gz
2017-05-26 16:02:54,442 - INFO - [Elapsed time: 0.96] Uploading...
2017-05-26 16:03:00,426 - INFO - [Elapsed time: 6.94] 2 of 7: Uploading /mnt/nas/MiSeq_Backup/141017/2014-SEQ-0484_S8_L001_R2_001.fastq.gz
2017-05-26 16:03:00,426 - INFO - [Elapsed time: 6.94] Uploading...
2017-05-26 16:03:21,119 - INFO - [Elapsed time: 27.63] 3 of 7: Uploading /mnt/nas/MiSeq_Backup/150210/2014-SEQ-1023_S11_L001_R1_001.fastq.gz
2017-05-26 16:03:21,119 - INFO - [Elapsed time: 27.63] Uploading...
2017-05-26 16:03:35,184 - INFO - [Elapsed time: 41.70] Galaxy isn't responding...
2017-05-26 16:03:35,189 - INFO - [Elapsed time: 41.70] Error: Galaxy isn't running/connection error.
2017-05-26 16:03:35,189 - INFO - [Elapsed time: 41.70] Waiting 30 seconds...
2017-05-26 16:04:05,221 - INFO - [Elapsed time: 71.73] Error: Galaxy isn't running/connection error.
2017-05-26 16:04:05,221 - INFO - [Elapsed time: 71.73] Waiting 30 seconds...
2017-05-26 16:04:35,254 - INFO - [Elapsed time: 101.77] Error: Galaxy isn't running/connection error.
2017-05-26 16:04:35,254 - INFO - [Elapsed time: 101.77] Waiting 30 seconds...
2017-05-26 16:05:05,286 - INFO - [Elapsed time: 131.80] Error: Galaxy isn't running/connection error.
2017-05-26 16:05:05,286 - INFO - [Elapsed time: 131.80] Waiting 30 seconds...
2017-05-26 16:05:35,322 - INFO - [Elapsed time: 161.84] Error: Galaxy isn't running/connection error.
2017-05-26 16:05:35,322 - INFO - [Elapsed time: 161.84] Waiting 1 hour...
2017-05-26 16:05:55,213 - INFO - [Elapsed time: 181.73] [Error Dump]
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 377, in _make_request
    httplib_response = conn.getresponse(buffering=True)
TypeError: getresponse() got an unexpected keyword argument 'buffering'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 560, in urlopen
    body=body, headers=headers)
  File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 379, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/lib/python3.5/http/client.py", line 1197, in getresponse
    response.begin()
  File "/usr/lib/python3.5/http/client.py", line 297, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.5/http/client.py", line 266, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/requests/adapters.py", line 376, in send
    timeout=timeout
  File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 610, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/usr/lib/python3/dist-packages/urllib3/util/retry.py", line 247, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/lib/python3/dist-packages/six.py", line 685, in reraise
    raise value.with_traceback(tb)
  File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 560, in urlopen
    body=body, headers=headers)
  File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 379, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/lib/python3.5/http/client.py", line 1197, in getresponse
    response.begin()
  File "/usr/lib/python3.5/http/client.py", line 297, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.5/http/client.py", line 266, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
requests.packages.urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 284, in upload_file
    self.gi.tools.upload_file(os.path.join(self.script_dir, "upload", path), self.history_id)
  File "/usr/local/lib/python3.5/dist-packages/bioblend/galaxy/tools/__init__.py", line 149, in upload_file
    return self._tool_post(payload, files_attached=True)
  File "/usr/local/lib/python3.5/dist-packages/bioblend/galaxy/tools/__init__.py", line 219, in _tool_post
    return Client._post(self, payload, files_attached=files_attached)
  File "/usr/local/lib/python3.5/dist-packages/bioblend/galaxy/client.py", line 157, in _post
    files_attached=files_attached)
  File "/usr/local/lib/python3.5/dist-packages/bioblend/galaxyclient.py", line 125, in make_post_request
    verify=self.verify, params=post_params)
  File "/usr/lib/python3/dist-packages/requests/api.py", line 107, in post
    return request('post', url, data=data, json=json, **kwargs)
  File "/usr/lib/python3/dist-packages/requests/api.py", line 53, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/lib/python3/dist-packages/requests/sessions.py", line 468, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/lib/python3/dist-packages/requests/sessions.py", line 576, in send
    r = adapter.send(request, **kwargs)
  File "/usr/lib/python3/dist-packages/requests/adapters.py", line 426, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 503, in wait_for_problem
    self.gi.histories.get_histories()
  File "/usr/local/lib/python3.5/dist-packages/bioblend/galaxy/histories/__init__.py", line 58, in get_histories
    histories = Client._get(self, deleted=deleted)
  File "/usr/local/lib/python3.5/dist-packages/bioblend/galaxy/client.py", line 133, in _get
    status_code=r.status_code)
bioblend.ConnectionError: HTTPConnectionPool(host='192.168.1.3', port=48888): Max retries exceeded with url: /api/histories?key=6589a82d08d7e9a5ff3f64dcc8fc3592 (Caused by NewConnectionError('<requests.packages.urllib3.connection.HTTPConnection object at 0x7fd9b948a588>: Failed to establish a new connection: [Errno 111] Connection refused',)), 0 attempts left: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 52, in run
    return self.main()  # Return the path to the results zip
  File "main.py", line 90, in main
    self.upload_file(file)
  File "main.py", line 301, in upload_file
    self.wait_for_problem()
  File "main.py", line 521, in wait_for_problem
    time.sleep(3600)
KeyboardInterrupt

